/******************************************************************************/
/****         Generated by IBExpert 2006.12.13 30.09.2007 16:20:01         ****/
/******************************************************************************/

SET SQL DIALECT 3;

SET NAMES WIN1251;

CREATE DATABASE 'A:\BASE1337.fdb'
USER 'SYSDBA' PASSWORD 'masterkey'
PAGE_SIZE 1024
DEFAULT_FETCHSIZE 100
DEFAULT CHARACTER SET WIN1251;



/******************************************************************************/
/****                               Domains                                ****/
/******************************************************************************/

CREATE DOMAIN CITIES AS
VARCHAR(20) CHARACTER SET WIN1251;

CREATE DOMAIN COMMS AS
DECIMAL(15,2);

CREATE DOMAIN DATES AS
DATE;

CREATE DOMAIN KEYS AS
INTEGER
NOT NULL;

CREATE DOMAIN MONEY AS
DECIMAL(15,2);

CREATE DOMAIN "NAMES" AS
VARCHAR(20) CHARACTER SET WIN1251
NOT NULL;

CREATE DOMAIN RATING AS
INTEGER;



/******************************************************************************/
/****                                Tables                                ****/
/******************************************************************************/



CREATE TABLE CUSTOMERS (
    CNAME   "NAMES",
    CITY    CITIES,
    RATING  RATING,
    SNAME   "NAMES"
);

CREATE TABLE ORDERS (
    ONUM   KEYS NOT NULL,
    AMT    MONEY,
    ODATE  DATES,
    SNAME  "NAMES",
    CNAME  "NAMES"
);

CREATE TABLE SALESPEOPLE (
    SNAME  "NAMES",
    CITY   CITIES,
    COMM   COMMS
);

INSERT INTO SALESPEOPLE (SNAME, CITY, COMM) VALUES ('Прохоров Н А', 'Рыбинск', 0.12);
INSERT INTO SALESPEOPLE (SNAME, CITY, COMM) VALUES ('Семенов Д О', 'Ростов', 0.13);
INSERT INTO SALESPEOPLE (SNAME, CITY, COMM) VALUES ('Александров Б С', 'Переславль', 0.1);
INSERT INTO SALESPEOPLE (SNAME, CITY, COMM) VALUES ('Матвеева Т В', 'Рыбинск', 0.11);
INSERT INTO SALESPEOPLE (SNAME, CITY, COMM) VALUES ('Русов С Н', 'Некоуз', 0.15);

COMMIT WORK;

INSERT INTO CUSTOMERS (CNAME, CITY, RATING, SNAME) VALUES ('Иванов Д В', 'Рыбинск', 100, 'Прохоров Н А');
INSERT INTO CUSTOMERS (CNAME, CITY, RATING, SNAME) VALUES ('Голованов Д Н', 'Ярославль', 200, 'Александров Б С');
INSERT INTO CUSTOMERS (CNAME, CITY, RATING, SNAME) VALUES ('Лосев К Н', 'Ростов', 200, 'Семенов Д О');
INSERT INTO CUSTOMERS (CNAME, CITY, RATING, SNAME) VALUES ('Гусева Т П', 'Данилов', 300, 'Семенов Д О');
INSERT INTO CUSTOMERS (CNAME, CITY, RATING, SNAME) VALUES ('Борисова Н В', 'Рыбинск', 100, 'Прохоров Н А');
INSERT INTO CUSTOMERS (CNAME, CITY, RATING, SNAME) VALUES ('Постнов Д С', 'Ярославль', 100, 'Матвеева Т В');
INSERT INTO CUSTOMERS (CNAME, CITY, RATING, SNAME) VALUES ('Викторов Л В', 'Данилов', 300, 'Русов С Н');

COMMIT WORK;

INSERT INTO ORDERS (ONUM, AMT, ODATE, SNAME, CNAME) VALUES (3001, 18.69, '2019-03-10', 'Русов С Н', 'Викторов Л В');
INSERT INTO ORDERS (ONUM, AMT, ODATE, SNAME, CNAME) VALUES (3002, 1900.1, '2019-03-10', 'Матвеева Т В', 'Постнов Д С');
INSERT INTO ORDERS (ONUM, AMT, ODATE, SNAME, CNAME) VALUES (3003, 767.19, '2019-03-10', 'Прохоров Н А', 'Иванов Д В');
INSERT INTO ORDERS (ONUM, AMT, ODATE, SNAME, CNAME) VALUES (3005, 5160.45, '2019-03-10', 'Прохоров Н А', 'Лосев К Н');
INSERT INTO ORDERS (ONUM, AMT, ODATE, SNAME, CNAME) VALUES (3006, 1098.16, '2019-03-10', 'Русов С Н', 'Викторов Л В');
INSERT INTO ORDERS (ONUM, AMT, ODATE, SNAME, CNAME) VALUES (3007, 75.75, '2019-04-10', 'Семенов Д О', 'Гусева Т П');
INSERT INTO ORDERS (ONUM, AMT, ODATE, SNAME, CNAME) VALUES (3008, 4723, '2019-05-10', 'Прохоров Н А', 'Борисова Н В');
INSERT INTO ORDERS (ONUM, AMT, ODATE, SNAME, CNAME) VALUES (3010, 1309.95, '2019-06-10', 'Семенов Д О', 'Гусева Т П');
INSERT INTO ORDERS (ONUM, AMT, ODATE, SNAME, CNAME) VALUES (3011, 9891.88, '2019-06-10', 'Прохоров Н А', 'Борисова Н В');

COMMIT WORK;



/******************************************************************************/
/****                             Primary Keys                             ****/
/******************************************************************************/

ALTER TABLE CUSTOMERS ADD CONSTRAINT PK_CUSTOMERS PRIMARY KEY (CNAME);
ALTER TABLE ORDERS ADD CONSTRAINT PK_ORDERS PRIMARY KEY (ONUM);
ALTER TABLE SALESPEOPLE ADD CONSTRAINT PK_SALESPEOPLE PRIMARY KEY (SNAME);


/******************************************************************************/
/****                             Foreign Keys                             ****/
/******************************************************************************/

ALTER TABLE CUSTOMERS ADD CONSTRAINT FK_CUSTOMERS_2 FOREIGN KEY (SNAME) REFERENCES SALESPEOPLE (SNAME) ON UPDATE CASCADE;
ALTER TABLE ORDERS ADD CONSTRAINT FK_ORDERS_1 FOREIGN KEY (SNAME) REFERENCES SALESPEOPLE (SNAME) ON DELETE SET DEFAULT ON UPDATE CASCADE;
ALTER TABLE ORDERS ADD CONSTRAINT FK_ORDERS_2 FOREIGN KEY (CNAME) REFERENCES CUSTOMERS (CNAME) ON DELETE SET DEFAULT ON UPDATE CASCADE;
